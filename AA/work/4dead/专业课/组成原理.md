# Q&A

1. Cache
   1. 映像规则
      1. 主存和Cache分为大小相同的若干块，主存以块为单位放入到Cache中
      2. 直接映射 组相联映射 全相联映射
   2. 查找算法
      1. 访存地址分为块地址和块内偏移地址
      2. 块地址低位查找叫做Index，索引组
      3. 高位Tag，用于判断是否命中
      4. 块内地址偏移用来从块中选出需要的数据
   3. 最近最少使用法LRU
      1. 选择最近最少没有被访问的块作为被替换的块。（实现比较困难）
      2. 实际上：选择最久没有被访问过的块作为被替换的块。 优点：命中率较高
   4. 两种写策略的比较
      1. 写回法的优点：速度快，占用存储器频带低-----搭配按写分配
      2. 写直达法的优点：易于实现，一致性好(无需脏块)----不按写分配
         1. 写回-按写分配下：写主存只发生在块替换时
            1. 写cache在命中/不命中情况下都会发生
   5. 平均访存时间 ＝ 命中时间＋不命中率×不命中开销
   6. CPU执行时间：(CPU执行周期数+存储器停顿周期数) * 时钟周期时间
      1. 存储器停顿周期数＝访存次数×失效率×失效开销
   7. 降低失效率 降低失效开销 减少命中时间
      1. 降低失效率
         1. 失效种类
            1. 强制性
            2. 容量失效
            3. 冲突失效
         2. 方法
            1. 增大块大小->增太多了失效率反而升高/会增加失效开销
            2. 增大组数->      失效率：容量为N 的直接映象Cache ≈ 容量为N/2的两路组相联Cache
            3. VICTIM CACHE
            4. 伪相连
            5. 预取(软硬件)
            6. 编译器优化 数据和指令重新组织
               1. 基本块对齐
               2. 分块
                  1. 把对数组的整行或整列访问改为按块进行
      2. 降低失效开销
         1. 写缓冲写合并
         2. 关键字优先
         3. 读失效优先于写
         4. 非阻塞Cache
            1. Cache失效时仍允许CPU进行其它的命中访问。
         5. 多级Cache
      3. 减少命中时间
         1. 容量小且结构简单
         2. 虚索引实标识
            1. 并非所有
               1. 不同进程可能使用相同的虚地址来指向不同的物理地址
               2. 某些共享空间，同一物理地址可能有不同形式的虚拟地址，这些地址又称为`别名`
               3. 虚拟索引＋物理标识
                  1. 利用虚拟地址找到索引读cache，同时进行虚实地址转换：
                  2. 前提是虚拟索引=物理索引
                     1. 页内位移在虚实地址变换时不变
                     2. 局限性：Cache容量受限 ≤ 页大小×相联度
2. 主存
   1. 存储器组织+存储器芯片
   2. 关注：延迟+带宽
      1. 增加存储器宽度
      2. 采用简单的多体交叉存储器
         1. 存储系统中采用多个DRAM，利用它们潜在的并行性

3. 虚存
   1. 由小主存和大辅存构成的系统，通过OS和硬件管理，给程序员提供的大于主存地址空间的一个地址空间
   2. 可以给cxy提供一个假象:自己好像独自占用了大于主存的一个地址空间

4. IO
   1. 接受CPU发来的I/O指令，根据指令要求选择一台指定的外围设备与通道相连接。
   2. 执行CPU为通道组织的通道程序，从主存中取出通道指令，对通道指令进行译码，并根据需要向被选中的设备控制器发出各种操作命令

5. 存储
   1. 提高存储速度
      1. 多端口
      2. 多模块存储器
         1. 单体多字存储器
            1. 每个存储单元存储m个字，总线宽度也为m个字。一次并行读出m个字
         2. 多体低位交叉存储器
            1. 存储器由多体模块组成，相同的容量和存取速度，独立的读写控制电路、地址寄存器和数据寄存器

6. CPU
   1. 微程序控制器/硬连线控制器 
